/*! Hubcap - http://hubcap.it/
* Copyright 2011-2012 Brodkin CyberArts.
* http://brodkinca.com/ 
* All rights reserved. */
jQuery(function(){jQuery("#my_repos").length>0&&jQuery.getJSON("/ajax/repos").success(function(a){var b=ich.my_repos_tpl(a);jQuery("#my_repos #target").html(b),jQuery("#my_repos #target .nav-tabs a:first").tab("show"),jQuery("#my_repos #target .dropdown-toggle").dropdown()}),jQuery("#my_repos #target").on("click",'a[data-action="activate"]',function(){var a=jQuery(this),b=a.closest("tr").data("repo");bootbox.confirm("Are you sure that you want to activate hubcap for "+b+"?",function(a){a&&jQuery.post("/ajax/activate",{repo:b}).success(function(){window.location.reload()}).error(function(){bootbox.alert("ERROR: Could not activate repository.")})})}),jQuery("#my_repos #target").on("click",'a[data-action="force-update"]',function(){var a=jQuery(this),b=a.closest("tr"),c=b.data("repo"),d=b.find(".branch-name").text();bootbox.confirm("Forcing an update will cause the latest commit to branch "+d+" of "+c+" to be queued for deployment. \n"+"Are you sure that you want to continue?",function(a){a&&jQuery.post("/ajax/repo_force_update",{repo:c}).error(function(){bootbox.alert("ERROR: Could not send update request.")})})}),jQuery("#my_repos #target").on("click",'a[data-action="deactivate"]',function(){var a=jQuery(this),b=a.closest("tr").data("repo");bootbox.confirm("Are you sure that you want to deactivate hubcap for "+b+"?",function(a){a&&jQuery.post("/ajax/deactivate",{repo:b}).success(function(){window.location.reload()}).error(function(){bootbox.alert("ERROR: Could not activate repository.")})})}),jQuery("#my_repos #target").on("mouseup",'a[data-action="branch-select"]',function(){var a=jQuery(this),b=a.closest("tr").data("repo");jQuery.getJSON("/ajax/repo_branches",{repo:b}).success(function(b){var c=ich.my_repos_branch_tpl(b);a.next(".dropdown-menu").html(c)}).error(function(){bootbox.alert("ERROR: Could not load branches from API.")})}),jQuery("#my_repos #target").on("click",'a[data-action="branch-update"]',function(){var a=jQuery(this),b=a.closest("tr").data("repo"),c=a.text();a.data("data-noclick")||jQuery.post("/ajax/repo_branch_update",{repo:b,branch:c}).success(function(b){a.closest(".dropdown-menu").prev(".dropdown-toggle").find(".branch-name").text(c)}).error(function(){bootbox.alert("ERROR: Could not update repository.")})}),hljs.initHighlighting(),jQuery("#nav_main").scrollspy()});